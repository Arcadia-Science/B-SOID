![Mouse Action Cluster Demo 0.75x](Demo/Ms2ActGMMClustVid_s.gif)

# B-SOID: Behavioral-Segmentation of Open-Field in DeepLabCut

B-SOID is an unsupervised learning algorithm written in MATLAB that analyzes sub-second rodent behavior using just a single camera from the bottom-up perspective. With the trajectory of 6 body parts outlining the rodent's body detected in DeepLabCut, this algorithm considers 7 unique time-varying signals and runs dimensionality reduction onto a 3D action space with the help of t-Distributed Stochastic Neighbor Embedding (t-SNE, MATLAB^TM). The algorithm then attempts to fit Gaussian Mixture Models onto t-SNE action clusters to pull out statistically significant distributions of physical characteristics. Although the primary purpose of integrated technology is to automatically detect rodent behaviors with one regular camera, the idea behind this can certainly apply to and benefit from multiple cameras and/or depth-sensors.  

## Installation

Use Git using the web URL or download ZIP. 

Change your current working directory to the location where you want the cloned directory to be made.

```bash
git clone https://github.com/YttriLab/B-SOID.git
```

## Usage

- ### Part I 

  ```matlab
  data_struct = importdata(filenamecsv); % .csv file generated by DLC
  rawdata = data_struct.data;
  data = dlc_preprocess(rawdata,0.5); % filter low likelihoods
  [g_label,g_num,perc_unk] = bsoid_fast(data,pix_cm); % data, pixel/cm
  ```

- ### Part II *a*

  ```matlab
  data_struct = importdata(filenamecsv); % .csv file generated by DLC
  rawdata = data_struct.data;
  data = dlc_preprocess(rawdata,0.5); % filter low likelihoods
  [f,tsne_f,g_ls,g_hs,llh,bsoid_fig] = bsoid_us(data,60); % data, sampling-rate
  % This will return the unlabeled groups. User then define by looking at representative gifs generated with the following code.
  ```

- ### Part II *b*

  ```matlab
  vidObj = VideoReader(filenamevid); % video used to generate DLC
  k = 1; kk = 1;
  while vidObj.CurrentTime < 599.9
      vidObj.CurrentTime = k/60;
      video{i}(kk).cdata = readFrame(vidObj); % save only every 10fps
      kk = kk+1; % save only every 10fps
      k = k+round(vidObj.FrameRate)/10; % reduce down to 10fps (100ms/frm)
  end
  [t,b,b_ex] = action_gif(video,grp_fill,1,5,6,0.75,filepathout);
  ```

- ### Part III

  ```matlab
  
  ```

  

## Contributing

Pull requests are welcome. For recommended changes that you would like to see, open an issue.

We are a neuroscience lab and can easily foresee this as being upgraded. Please do not hesitate in helping us working towards a more efficient and accurate algorithm. All major contributors will be cited in our publications.

## License

This software package provided without warranty of any kind and is licensed under the GNU Lesser General Public License v3.0. 
Cite us if you use the code and/or data!.https://choosealicense.com/licenses/mit/)
